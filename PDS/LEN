/* REXX LEN*/
ISREDIT "MACRO"
A = "'" ; Q = '"' ; LN = 0 ; C = "EQ"
COLUMNS = "----+----1----+----2"| |,
"----+----3----+----4----+----5"| |,
"----+----6----+----7----+----8";
ISREDIT "(NUM1,NUM2) = "NUMBER
PARSE VAR NUM2 NBR COB XTRA;
ISREDIT "(CURSROW,CURSCOL) = "CURSOR
ISREDIT "(LRECL) = "LRECL
ISREDIT "(EDITLINE) = LINE "CURSROW
IF NBR = "STD" THEN LRECL = LRECL - 8;
IF COB = "COBOL" THEN LRECL = LRECL - 6;
IF CURSCOL > 0 THEN DO
   BEGPOS = CURSCOL - 1
   STRING1 = SUBSTR(EDITLINE,CURSCOL,(LRECL - BEGPOS))
   IF SUBSTR(STRING1,1,1) = A THEN DO
      X = A ; BEGPOS = BEGPOS + 1
      CALL BYTESCAN ; END
   ELSE
   IF SUBSTR(STRING1,1,1) = Q THEN DO
      X = Q ; BEGPOS = BEGPOS + 1
      CALL BYTESCAN ; END
   ELSE
   IF SUBSTR(STRING1,1,1) = " " THEN DO
      LN = LENGTH(STRING1) ; C = "NE"
      CALL BYTESCAN ; END
   ELSE DO
   PARSE VAR STRING1 FIRST XTRA
   LN = LENGTH(FIRST)
   END
END
IF LN > 0 THEN DO
   ZMSG000S = LN" CHARACTERS LONG"
   WRK1 = SUBSTR(" ",1,BEGPOS)| |SUBSTR(COLUMNS,1,LN)
   ISREDIT "LINE_AFTER "CURSROW" = INFOLINE '&WRK1'"
   ISREDIT "CURSOR = (CURSROW,CURSCOL)"
   END
ELSE DO
ZMSG000S = "CANNOT DETERMINE LENGTH"
ZMSG000L = "CURSOR NOT IN DATA, STRIN"| |,
"G CONTAINS MIS-MATCHED QUOTES OR OTH"| |,
"ER ERROR OCCURED."
END
ISPEXEC "SETMSG MSG(ISPZ000)"
EXIT
/* -------- SCANNING SUBROUTINES---------------*/
BYTESCAN: DO I=2 TO LENGTH(STRING1) BY 1
IF C = "EQ" THEN CALL EQSCN
ELSE CALL NESCN
END ; RETURN
EQSCN:  IF SUBSTR(STRING1,I,1) = X THEN DO
LN = I - 2 ; I = LENGTH(STRING1)
END ; RETURN
NESCN:  IF SUBSTR(STRING1,I,1) \= " " THEN DO
LN = I - 1 ; I = LENGTH(STRING1)
END ; RETURN
